<script type="text/template" charset="utf-8" id="ordergoodsSearchFm">
<div class="weui-media-box weui-media-box_small-appmsg" style="width: 100%; z-index:2;" >
    <div class="weui-cells">
        <div class="weui-search-bar weui-search-bar_focusing" id="GSearchBar">
        <div id='xiadingdansearchkey' style="display:none"></div>
            <form class="weui-search-bar__form">
                <div class="weui-search-bar__box"> <i class="weui-icon-search" style=" margin-top:5px;"></i>
                    <input type="search" class="weui-search-bar__input" id="GSearchInput" placeholder="请输入商品名称或商品货号" required  style="height:30px;" />
                    <a href="javascript:" class="weui-icon-clear" id="GSearchClear" style=" margin-top:5px;"></a> 
                </div>
            </form>
        </div>
    </div>
</div>
<script type="text/javascript">
    var lock = false,
    $searchBar = $('#GSearchBar'),
    $searchInput = $('#GSearchInput'),
    $searchClear = $('#GSearchClear');
    function searchxiadingdanG(t){
        var s=$('#xiadingdansearchkey').html();
        if(t!=' '&& s!=t){
            $('#xiadingdansearchkey').html(t);
            bjquery({t:t});
        }
    }
    function hideSearchResultG(){
        $searchInput.val('');
    }
    function cancelSearchG(){
        $searchBar.removeClass('weui-search-bar_focusing');
    }
    $searchInput.on('blur', function () {
        if(!this.value.length) cancelSearchG();
    }).on(
        {
            compositionstart:function(){
                lock = true;
            },
            compositionend:function(){
                lock = false;
            },
            input:function(){
                var that = this;
                if(typeof t !== 'undefined'){
                    clearTimeout(t);
                }
                t = setTimeout(function (){
                    if(!lock){
                        if(that.value.length){
                            searchxiadingdanG(that.value);
                        }else{
                            hideSearchResultG();
                            $searchInput.focus();
                            searchxiadingdanG(that.value);
                            clearTimeout(t);
                        }
                    }
                },200);
            }
        }
    );
    $searchClear.on('click', function(){
        hideSearchResultG();
        $searchInput.focus();
        searchxiadingdanG('');
    });    
</script>
</script>
